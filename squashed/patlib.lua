function clamp(x,l,r)return max(min(x,r),l)end
function mmin(a,b,c,...)return min(a,c and mmin(b,c,...)or b)end
function mr(a,s)return min(a,s-1-a)end
function hash(...)local r=0	for v in all{...}do r+=v r+=shl(r,10) r=bxor(r,shr(r,6))end	r+=shl(r,3) r=bxor(r,shr(r,11))r+=shl(r,15) return flr(r)end
_fptrs={function(x,y)return y end,function(x)return x end,function(x,y)return x+y end,function(x,y)return y-x+1 end,function(x,y)return x*y end,	function(x,y)return x^y end,function(x,y)return y^x end,function(x,y)return min(x,y)end,function(x,y)return max(x,y)end,function(x,y)return max(x%y,y)end,function(x,y)return max(x,y%x)end,function(x,y,w,h,n)return clamp(mmin(x,y,w-x-1,h-y-1),0,n-1)end,function(x,y,w,h,n)return clamp(mmin(x*2,y*2,(w-x-1)*2+1,(h-y-1)*2+1),0,n-1)end}_pat={[0]=function(a,x,y,w,h,n)return _fptrs[a]and _fptrs[a](x,y,w,h,n)or 0 end,hash}_trn={[0]=function(x,y)return x,y end,function(x,y,w)return mr(x,w),y end,function(x,y,w,h)return x,mr(y,h)end,function(x,y,w,h)return mr(x,w),mr(y,h)end,function(x,y,w,h)return min(x,y),max(x,y)end,function(x,y,w,h)return min(x,h-y-1),max(x,h-y-1)end}
function pat(p,a,x,y,w,h,c,l)local l,n=plot or pset,#_trn+1 local t=_trn[p%n]p=_pat[flr(p/n)]for v=0,h-1 do for u=0,w-1 do local i,j=t(u,v,w,h)l(x+u,y+v,c[p(a,i,j,w,h,#c)%#c+1])end end end